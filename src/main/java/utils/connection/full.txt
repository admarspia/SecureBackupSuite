./ConnectionTester.java
package utils.conncetion;

import exception.conncetion.ConnectionTestException;

public ConnectionTester {
    StorageConfigModel config;
    public ConnectionTester(StorageConfigModel config){
        this.config = config;
    }
    
    public boolean auth(){
        try {
            ConnectionHandler handler =  ConnectionHandlerResolver.getHandler(config);
            if (handler == null) 
                return false;
            return handler.test();
        }catch (Exception ex){
            ConnectionTestException("Connection Failed.", ex);
        }
    }

}
./NFSConnectionHandler.java
package utils.connection;

public class NFSConnectionHandler {

}
./helpers/CredentialUtils.java
package utils.connetion.helprs;


import java.nio.Files;
import java.nio.Path;
import java.io.IOException;

public class CredentialUtils {
    public static String readPasswrodPath(String path) throws IOException {
        Path = Path.of(path);
        return Files.readAllLines(path, StandardCharsets.UTF-8).get(0).trim();  //get first line 

    }

    private static fileExists(String path) throws IOException {
        return path != null && Files.exists(Path.of(path));
    }

}
./helpers/NetworkUtils.java
package utils.connection.helpers;

import java.io.IOException;
import java.net.InetAddress;
import java.net.InetSocketAddress;
import java.net.Socket;
import java.net.UnknownHostException;


public class NetworkUtils(){
    private NetworkUtils() {}

    public static void ValidateHostReachable(String host, int timeout) throws HostUnreachableException {
        try {
            InetAddress.getByName(host) // this way we can make DNS resolution
        } catch (UnknownHostException ex){
            throw new HostUnreachableException(host, ex);
        }

        try (Socket s = new Socket()) {
            s.connect(new InetSocketAddress(host, 80), timeout);
        }catch (IOException ex){
            throw new HostUnreachableException(host, ex);
        }
    }

    public static boolean isPortOpen(String host, int port, int timeout) {
        try (Socket s = new Socket()) {
            s.connect(new InetSocketAddress(host, port), timeout);
            return true;

        } catch (IOException ex){
            return false;

        }
    }
}
./ConnectionHandler.java
package utils.connection;

import config.user_config.storage_config.StorageConfigModel;

public interface ConnectionHandler {
    boolean test(StorageConfigModel config);
}
./CloudConnectionHandler.java
package utils.connection;


public class CloudConnectionHandler{
    
}
./SMBConnectionHandler.java
package utils.connection;

import com.hierynomus.smbj.SMBClient;
import com.hierynomus.smbj.connection.Connection;
import com.hierynomus.smbj.auth.AuthenticationContext;
import com.hierynomus.smbj.session.Session;
import com.hierynomus.smbj.share.DiskShare;
import com.hierynomus.smbj.common.SMBApiException;
import com.hierynomus.smbj.auth.AuthenticationException;

import java.io.IOException;
import java.util.Objects;

import utils.connection.helpers.*;
import exception.connection.*;
import config.user_config.storage_config.StorageConfigModel;

public class SMPConnectionHandler implements ConnectionHandler {
    private static final int PORT = 445;
    private static final int CONNECT_TIMEOUT_MS = 5000;
    
    public test()

    public static SMBClient openConnection(
            String host, String username, String password, String share
    ) {

        Objects.requireNonNull(host, "host is required");
        Objects.requireNonNull(share, "share is required");

        if (!NeworkUtils.isPortOpen(PORT))
            throw new HostUnreachableException(host);

        SMBClient client = new SMBClient();

        try (Connection connection = client.connect(host)) {

            AuthenticationContext ac = new AuthenticationContext(
                    username == null ? "" : username,
                    password == null ? "".toCharArray() : password.toCharArray(),
                    null
            );

            Session session = connection.authenticate(ac);

            try (DiskShare disk = (DiskShare) session.connectShare(share)) {
                disk.list("");  // to test accessablity
                return client;
            } catch (SMBApiException ex) {
                throw new ShareNotFoundException(
                        "Couldn't open share " + share + " on host " + host,
                        ex
                );
            }

        } catch (IOException ex) {
            throw new ConnectionTestException(
                    "Couldn't connect to remote SMB server",
                    ex
            );

        } catch (AuthenticationException ex) {
            throw new AuthFailedException("Authentication failed", ex);
        }
    }

    public static boolean closeConnection(SMBClient client) {
        try {
            if (client != null) client.close();
            return true;
        } catch (IOException ex) {
            return false;
        }
    }
}



./SFTPConnectionHandlery.java
package utils.connection;

import com.jcraft.jsch.ChannelExec;
import com.jcraft.jsch.JSch;
import com.jcraft.jsch.JSchException;
import com.jcraft.jsch.Session;

import java.util.Objects;

import utils.connection.helpers.*;
import utils.connection.helpers.
import exception.connection.*;

public class SFTPConnectionHandler implements ConnectionHandler {

    private static final int DEFAULT_PORT = 22;
    private static final int CONNECT_TIMEOUT_MS = 5000;

        
    public test(StorageConfigModel config){
        try {
            String password = CredentialUtils.readPasswrodPath(config.getPasswordPath());

            SFTPConnectionHandler.getSessionByPassword(confi.getUser(), config.getHost(), config.getPort(), password );

            return true ;
        } catch (Exception ex){
            return false;
        }

    }


    public static Session getSessionByPassword(String username, String host, int port, String password)
        throws HostUnreachableException, ConnectionTestException
        {

        try {
            Objects.requireNonNull(host, "host is required");

            JSch jsch = new JSch();

            int realPort = (port <= 0) ? DEFAULT_PORT : port;

            NetworkUtils.validateHostReachable(host);

            if (!NetworkUtils.isPortOpen(realPort)) {
                throw new HostUnreachableException(host);
            }

            Session session = jsch.getSession(
                    username == null ? "" : username,
                    host,
                    realPort
            );

            session.setPassword(password);
            session.setConfig("StrictHostKeyChecking", "no");

            session.connect(CONNECT_TIMEOUT_MS);
            return session;

        } catch (HostUnreachableException ex) {
            throw ex;
        } catch (JSchException ex) {
            throw new ConnectionTestException("Failed to connect to host: " + host, ex);
        }
    }

    public static ChannelExec openExecChannel(Session session) 
        throws ConnectionTestException
    {
        try {
            Objects.requireNonNull(session, "session is required");

            ChannelExec exec = (ChannelExec) session.openChannel("exec");
            return exec;

        } catch (JSchException ex) {
            throw new ConnectionTestException("Failed to open exec channel.", ex);
        }
    }

    public static Session getSessionByPrivateKeyPassKey(String username, String host, String privateKeyPath, String passPhrase, int port) 
        throws  ConnectionTestException, HostUnreachableException 
    {
        try {
            Objects.requireNonNull(username, "username can't be empty");
            Objects.requireNonNull(host, "host can't be empty");
            Objects.requireNonNull(privateKeyPath, "privatekey path can't be empty");

            int realPort = port <= 0 ?  DEFAULT_PORT : port;

            NetworkUtils.validateHostReachable(host);

            if (!NetworkUtils.isPortOpen(realPort))
                throw new HostUnreachableException(host);

            if (!CredentialUtils.fileExists(privateKeyPath))
                throw new ConnectionTestException("private key file path doesn't exist"); 

            JSch jsch = new JSch();

            Session session = null;

            session = jsch.getSession(username, host, realPort);
            
            if (passPhrase == null) {
                session.addIdentity(privateKeyPath);
            }else
                session.addIdentity(privateKeyPath, passPhrase);
            session.setConfig("StrictHostKeyChecking", "no");

            session.connect(CONNECT_TIMEOUT_MS);
                
            return session;
        } catch (JSchException ex){
            throw new ConnectionTestException("Couldn't create session with host: " + host, ex);
        } catch (HostUnreachableException ex) {
            throw ex;
        } 

    }
}

./ConnectionResolver.java
package utils.connection;

import config.user_config.storage_confg.StorageConfigModel;

public class ConnectionHandlerResolver {
    public ConnectionHandler getHandler(StorageConfigModel config){
        switch (config.getType()) {
            case config.SMB: return SMBConnectionHandler.test();
            case config.SFTP: return SFTPConnectionHandler.test();
            case config.Cloud: return;
            case config.NFS:    return;
            default: throw new UnsupportedOperationException("Unsupported Operation: " + config.getType());
        }
    }
}
